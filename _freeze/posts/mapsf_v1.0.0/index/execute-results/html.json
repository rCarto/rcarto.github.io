{
  "hash": "971fbfc0738d9d19d6a369478315e4eb",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"New release of `mapsf`: version 1.0.0\"\nauthor: \"Timoth√©e Giraud\"\ndate: \"2025-06-16\"\ncategories: [mapsf]\nimage: \"front.png\"\ndraft: true\nbibliography: references.bib\nresources:\n  - com.gpkg\n\n---\n\nThe first major version of `mapsf` has been deployed on CRAN.   \nThis new release introduces many new features and fixes.\nIn this post I'll show some of the new features of the package:\n\n- The new theming system\n- The updated display of map elements\n- The updated Cheat Sheet\n- A new way of designing color palettes\n\nThe dataset used in the following examples is about apartment rental prices in 2023 (<small>[source](https://www.data.gouv.fr/fr/datasets/carte-des-loyers-indicateurs-de-loyers-dannonce-par-commune-en-2023/#/resources/43618998-3b37-4a69-bb25-f321f1a93ed1)</small>).  \n<small>Download the dataset:</small> [{{< fa download >}}](com.gpkg)\n\n\n\n## New cartographic themes\n\nA new theming system has been introduced, it has lead to new default values and a new default map style.   \n**`mf_theme()`** sets a map theme. A theme is a set of graphical parameters that are applied to maps created with `mapsf`. These parameters are figure margins; frames; background, foreground and highlight colors; default sequential and qualitative palettes; title options (position, size, banner, etc.).  \nThemes are persistent across maps produced by `mapsf` (e.g. they survive a `dev.off()` call). \n\n\n### The default theme\nThe default theme is called \"base\". \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(mapsf)\ncom <- sf::st_read(\"com.gpkg\", quiet = TRUE)\nmf_theme(\"base\")\nmf_map(com)\nmf_title(\"New default theme\")\nmf_scale()\nmf_credits()\nmf_arrow()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=480}\n:::\n:::\n\n\n\n### Builtin themes\n\n`mapsf` offers some builtin themes. It's possible to modify an existing theme or to start a theme from scratch. If you want to have a look at the 8 builtin themes you can go to the [vignette about themes on `mapsf` website](https://riatelab.github.io/mapsf/#/vignettes/how_to_use_themes)\n\n\n::: {.cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nmf_theme(\"sol_light\")\nmf_map(com, 'loypredm2', 'choro', breaks = \"ckmeans\", nbreaks = 4)\nmf_title('sol_light theme')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=384}\n:::\n\n```{.r .cell-code}\nmf_theme(\"sol_light\", highlight = \"brown\", title_banner = TRUE, pal_seq = \"Teal\")\nmf_map(com, 'loypredm2', 'choro', breaks = \"ckmeans\", nbreaks = 4)\nmf_title('Modified sol_light theme')\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=384}\n:::\n:::\n\n\n\n### How to get back to the former default\n\nIf you need to use the former (pre v1.0.0) default theme, use the \"default\" theme: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nmf_theme(x = \"default\")\nmf_map(com)\nmf_title(\"Former default theme\")\nmf_scale()\nmf_credits()\nmf_arrow()\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=288}\n:::\n:::\n\n\n## Better display of map elements\n\nIn this new version, map elements are redrawn when the graphic device is resized. This behaviour is a great improvement for interactive map displays, particularly when using RStudio or Positron. \n\n### Previous release\n{{< video previous.mp4 title='mapsf v0.12.0' >}}\n\n### Current release\n{{< video current.mp4 title='mapsf v1.0.0' >}}\n\n\n## Updated Cheat Sheet\n\nThe cheat sheet has been updated to reflect the changes that has happened in the package.   \n<small>Get the PDF file of the cheat sheet:</small> [{{< fa download >}}](https://raw.githubusercontent.com/riatelab/mapsf/master/vignettes/fig/mapsf_cheatsheet.pdf)\n\n![](front.png)\n\n\n\n::: {.cell}\n\n:::\n\n\n\n## Diverging color palettes\n\n`mf_get_pal()` has been modified to make it easier to create diverging color palettes based on a vector of break values. \n\nIn the following examples, we use a [classification method based on the mean and the standard deviation](https://magrit.cnrs.fr/en/functionalities/classification.html#mean-and-standard-deviation) of a distribution. Using this method the mean value can be a class boundary (example 1) or a class center (example 2). \n\n### Use a class boundary\nThe first step consist in creating the vector of break values. We use `central = FALSE` to have the mean as a break value. Then we use `mf_get_pal()` with the breaks vector, the mean value and 2 color palette names to create the corresponding diverging color palette.\n\n::: {.cell}\n\n```{.r .cell-code}\nbks_1 <- mf_get_breaks(x = com$loypredm2, breaks = \"msd\", central = FALSE)\npal_1 <- mf_get_pal(breaks = bks_1, mid = mean(com$loypredm2), \n                    palette = c(\"Burg\", \"Teal\"))\nmf_map(com, \"loypredm2\", \"choro\", breaks = bks_1, pal = pal_1)\nmf_title(\"Diverging color palette\", cex = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=384}\n:::\n:::\n\n\n\n### Use a class center (or any value)\nIn this second example, we use the same method but using a central class (`central = TRUE`). The resulting palette has a neutral color for the central classe that contains the mean value.\n\n::: {.cell}\n\n```{.r .cell-code}\nbks_2 <- mf_get_breaks(x = com$loypredm2, breaks = \"msd\", central = TRUE)\npal_2 <- mf_get_pal(breaks = bks_2, mid = mean(com$loypredm2), \n                    palette = c(\"Burg\", \"Teal\"))\nmf_map(com, \"loypredm2\", \"choro\", breaks = bks_2, pal = pal_2)\nmf_title(\"Diverging color palette with a neutral color\", cex = 1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=384}\n:::\n:::\n\n\n\n\n\n-------\n\n**See the [NEWS file](https://raw.githubusercontent.com/riatelab/mapsf/master/NEWS.md) for the complete list of changes.**\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}